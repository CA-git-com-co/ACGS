# DeepSeek R1 Migration Pilot Environment Configuration
# ACGS-PGP Phase 1 Implementation - Week 1-4
# Expected: 96.4% cost reduction, maintained constitutional compliance >95%

# =============================================================================
# DeepSeek R1 Pilot Configuration
# =============================================================================

# Pilot Control (Critical Priority)
DEEPSEEK_R1_PILOT_ENABLED=true
DEEPSEEK_R1_TRAFFIC_PERCENTAGE=10
DEEPSEEK_R1_COMPLIANCE_THRESHOLD=0.95
DEEPSEEK_R1_RESPONSE_TIME_THRESHOLD=2000
DEEPSEEK_R1_COST_TRACKING=true
DEEPSEEK_R1_FALLBACK_ENABLED=true

# Constitutional Integrity (Critical Priority)
ACGS_CONSTITUTIONAL_HASH=cdd01ef066bc6cf2
ACGS_DGM_SAFETY_ENABLED=true
ACGS_HUMAN_REVIEW_THRESHOLD=0.90
ACGS_EMERGENCY_SHUTDOWN_ENABLED=true
ACGS_RTO_MINUTES=30

# =============================================================================
# OpenRouter API Configuration
# =============================================================================

# API Credentials (Set these in your environment)
OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
OPENROUTER_ENDPOINT=https://openrouter.ai/api/v1/chat/completions

# Model Configuration
DEEPSEEK_R1_MODEL=deepseek/deepseek-r1-0528:free
DEEPSEEK_R1_TEMPERATURE=0.0
DEEPSEEK_R1_MAX_TOKENS=8192
DEEPSEEK_R1_TIMEOUT_SECONDS=30
DEEPSEEK_R1_RETRY_ATTEMPTS=3

# Request Headers
OPENROUTER_HTTP_REFERER=https://acgs-pgp.ai
OPENROUTER_X_TITLE=ACGS-PGP Constitutional AI

# =============================================================================
# A/B Testing Configuration
# =============================================================================

# Traffic Routing
AB_TESTING_ENABLED=true
AB_TESTING_METHOD=consistent_hash
AB_TESTING_HASH_KEY=request_id
AB_CONTROL_PERCENTAGE=90
AB_TREATMENT_PERCENTAGE=10

# Success Criteria
AB_CONSTITUTIONAL_COMPLIANCE_MIN=0.95
AB_RESPONSE_TIME_MAX_MS=2000
AB_COST_REDUCTION_TARGET_PERCENT=90.0
AB_SUCCESS_RATE_MIN=0.98

# =============================================================================
# Cost Analysis Configuration
# =============================================================================

# Current Model Costs (per 1M tokens)
COST_CLAUDE_3_7_SONNET=15.00
COST_GPT_4=30.00
COST_PERPLEXITY_SONAR=5.00
COST_DEEPSEEK_R1=0.55

# Projection Settings
ANNUAL_REQUEST_VOLUME=1000000
AVERAGE_TOKENS_PER_REQUEST=500
PROJECTED_ANNUAL_SAVINGS=1620000
COST_REDUCTION_PERCENTAGE=96.4

# =============================================================================
# Monitoring and Alerting Configuration
# =============================================================================

# Metrics Collection
METRICS_COLLECTION_ENABLED=true
METRICS_INTERVAL_SECONDS=30
METRICS_RETENTION_DAYS=90
METRICS_EXPORT_ENABLED=true

# Alert Thresholds (4-Tier Priority System)
ALERT_CRITICAL_COMPLIANCE_THRESHOLD=0.75
ALERT_CRITICAL_RESPONSE_TIME_MS=5000
ALERT_HIGH_COMPLIANCE_THRESHOLD=0.90
ALERT_HIGH_RESPONSE_TIME_MS=2000
ALERT_HIGH_ERROR_RATE=0.05
ALERT_MODERATE_COMPLIANCE_THRESHOLD=0.95
ALERT_MODERATE_RESPONSE_TIME_MS=1500
ALERT_MODERATE_COST_INCREASE_PERCENT=10
ALERT_LOW_FALLBACK_RATE=0.10
ALERT_LOW_CACHE_MISS_RATE=0.20

# Reporting
REPORTING_ENABLED=true
REPORTING_INTERVAL_MINUTES=5
DASHBOARD_ENABLED=true
DASHBOARD_PORT=3001

# =============================================================================
# Blue-Green Deployment Configuration
# =============================================================================

# Deployment Strategy
DEPLOYMENT_STRATEGY=blue_green
DEPLOYMENT_PHASE=phase_1

# Phase 1: Initial Pilot (Week 1)
PHASE_1_DURATION_DAYS=7
PHASE_1_TRAFFIC_PERCENTAGE=10
PHASE_1_CONSTITUTIONAL_COMPLIANCE_MIN=0.95
PHASE_1_RESPONSE_TIME_P95_MAX=2000
PHASE_1_ERROR_RATE_MAX=0.01

# Rollback Configuration
ROLLBACK_AUTOMATIC_ENABLED=true
ROLLBACK_COMPLIANCE_THRESHOLD=0.90
ROLLBACK_RESPONSE_TIME_THRESHOLD=3000
ROLLBACK_ERROR_RATE_THRESHOLD=0.05
ROLLBACK_SERVICE_UNAVAILABLE_SECONDS=60
ROLLBACK_STRATEGY=immediate

# Notification Channels
NOTIFICATION_SLACK_ENABLED=false
NOTIFICATION_EMAIL_ENABLED=false
NOTIFICATION_PAGERDUTY_ENABLED=false

# =============================================================================
# Service Integration Configuration
# =============================================================================

# ACGS-PGP Service Endpoints
AC_SERVICE_ENDPOINT=http://localhost:8001
PGC_SERVICE_ENDPOINT=http://localhost:8005
INTEGRITY_SERVICE_ENDPOINT=http://localhost:8002
AUTH_SERVICE_ENDPOINT=http://localhost:8000
GS_SERVICE_ENDPOINT=http://localhost:8004
FV_SERVICE_ENDPOINT=http://localhost:8003
EC_SERVICE_ENDPOINT=http://localhost:8006

# Service Integration Settings
CONSTITUTIONAL_VALIDATION_ENABLED=true
POLICY_ENFORCEMENT_ENABLED=true
OPA_INTEGRATION_ENABLED=true
HASH_VALIDATION_ENABLED=true
AUDIT_LOGGING_ENABLED=true

# =============================================================================
# Environment-Specific Overrides
# =============================================================================

# Development Environment
ENVIRONMENT=development
DEBUG=false
LOG_LEVEL=INFO

# Resource Limits (Standard ACGS-PGP)
CPU_REQUEST=200m
CPU_LIMIT=500m
MEMORY_REQUEST=512Mi
MEMORY_LIMIT=1Gi

# Database Configuration
DATABASE_URL=postgresql://acgs_user:acgs_password@localhost:5432/acgs_development
REDIS_URL=redis://localhost:6379/0

# =============================================================================
# Compliance and Governance Configuration
# =============================================================================

# Constitutional AI Compliance
CONSTITUTIONAL_AI_ENABLED=true
CONSTITUTIONAL_HASH_VERIFICATION=true
COMPLIANCE_LOGGING_ENABLED=true
AUDIT_TRAIL_ENABLED=true

# Data Governance
PII_DETECTION_ENABLED=true
DATA_RETENTION_DAYS=90
ENCRYPTION_AT_REST=true
ENCRYPTION_IN_TRANSIT=true

# Regulatory Compliance
GDPR_COMPLIANCE=true
CCPA_COMPLIANCE=true
AUDIT_REQUIREMENTS=true

# =============================================================================
# Performance Optimization Configuration
# =============================================================================

# Caching Configuration (for Phase 2)
CACHING_ENABLED=false
L1_CACHE_SIZE_KB=64
L2_CACHE_SIZE_KB=512
L3_CACHE_REDIS_ENABLED=true
BLOOM_FILTER_ENABLED=false
BLOOM_FILTER_FALSE_POSITIVE_RATE=0.001

# Circuit Breaker Configuration
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=100
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=30
CIRCUIT_BREAKER_HALF_OPEN_MAX_CALLS=10

# =============================================================================
# Security Configuration
# =============================================================================

# API Security
API_RATE_LIMITING_ENABLED=true
API_RATE_LIMIT_REQUESTS_PER_MINUTE=1000
API_AUTHENTICATION_REQUIRED=true
API_AUTHORIZATION_ENABLED=true

# Network Security
CORS_ENABLED=true
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
HTTPS_ONLY=false
TLS_VERSION=1.2

# =============================================================================
# Logging Configuration
# =============================================================================

# Log Levels
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_TIMESTAMP_FORMAT=iso8601

# Log Destinations
LOG_TO_CONSOLE=true
LOG_TO_FILE=true
LOG_FILE_PATH=/var/log/acgs/deepseek-r1-pilot.log
LOG_FILE_MAX_SIZE_MB=100
LOG_FILE_MAX_FILES=10

# Structured Logging
STRUCTURED_LOGGING_ENABLED=true
LOG_REQUEST_ID=true
LOG_CONSTITUTIONAL_HASH=true
LOG_PERFORMANCE_METRICS=true
LOG_COST_METRICS=true

# =============================================================================
# Testing Configuration
# =============================================================================

# Load Testing
LOAD_TESTING_ENABLED=false
LOAD_TESTING_CONCURRENT_USERS=100
LOAD_TESTING_DURATION_SECONDS=300
LOAD_TESTING_RAMP_UP_SECONDS=60

# Integration Testing
INTEGRATION_TESTING_ENABLED=true
INTEGRATION_TEST_TIMEOUT_SECONDS=30
INTEGRATION_TEST_RETRY_ATTEMPTS=3

# Constitutional Compliance Testing
COMPLIANCE_TESTING_ENABLED=true
COMPLIANCE_TEST_CASES_PATH=/config/test-cases/constitutional
COMPLIANCE_TEST_THRESHOLD=0.95

# Performance Testing
PERFORMANCE_TESTING_ENABLED=true
PERFORMANCE_TEST_RESPONSE_TIME_TARGET_MS=2000
PERFORMANCE_TEST_THROUGHPUT_TARGET_RPS=100
