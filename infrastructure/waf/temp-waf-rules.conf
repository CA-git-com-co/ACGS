# Temporary WAF rules to block common SQL injection strings
# Sprint 0 security hot-fix

SecRuleEngine On

# Block typical SQL injection attempts
SecRule ARGS "(?i:(\bor\b|\band\b)\s+1=1)" "id:1001,phase:2,deny,msg:'SQL injection pattern OR 1=1'"
SecRule ARGS "(?i:union(\s+all)?\s+select)" "id:1002,phase:2,deny,msg:'SQL injection pattern UNION SELECT'"
SecRule ARGS "(?i:select.+from)" "id:1003,phase:2,deny,msg:'SQL injection pattern SELECT FROM'"

# Block attempts to terminate queries
SecRule ARGS ";--" "id:1004,phase:2,deny,msg:'SQL injection comment pattern'"

SecRuleUpdateTargetByTag "id:1001,1002,1003,1004" "ARGS"
