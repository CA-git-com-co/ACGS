filebeat.inputs:
- type: log
  enabled: true
  paths:
  - /var/log/acgs/services/*.log
  - /var/log/acgs/services/*/*.log
  fields:
    log_type: acgs-service
    environment: production
    system: acgs-1
  fields_under_root: true
  multiline.pattern: ^\d{4}-\d{2}-\d{2}
  multiline.negate: true
  multiline.match: after
- type: log
  enabled: true
  paths:
  - /var/log/acgs/security/*.log
  fields:
    log_type: acgs-security
    environment: production
    system: acgs-1
  fields_under_root: true
  json.keys_under_root: true
  json.add_error_key: true
- type: log
  enabled: true
  paths:
  - /var/log/acgs/auth/*.log
  fields:
    log_type: acgs-auth
    environment: production
    system: acgs-1
  fields_under_root: true
  json.keys_under_root: true
  json.add_error_key: true
- type: log
  enabled: true
  paths:
  - /var/log/acgs/audit/*.log
  fields:
    log_type: acgs-audit
    environment: production
    system: acgs-1
  fields_under_root: true
  json.keys_under_root: true
  json.add_error_key: true
- type: log
  enabled: true
  paths:
  - /var/log/acgs/governance/*.log
  fields:
    log_type: acgs-governance
    environment: production
    system: acgs-1
  fields_under_root: true
  json.keys_under_root: true
  json.add_error_key: true
- type: log
  enabled: true
  paths:
  - /var/log/auth.log
  fields:
    log_type: system-auth
    environment: production
    system: acgs-1
  fields_under_root: true
- type: log
  enabled: true
  paths:
  - /var/log/syslog
  fields:
    log_type: system
    environment: production
    system: acgs-1
  fields_under_root: true
- type: log
  enabled: true
  paths:
  - /var/log/nginx/access.log
  fields:
    log_type: nginx-access
    environment: production
    system: acgs-1
  fields_under_root: true
- type: log
  enabled: true
  paths:
  - /var/log/nginx/error.log
  fields:
    log_type: nginx-error
    environment: production
    system: acgs-1
  fields_under_root: true
filebeat.config.modules:
  path: ${path.config}/modules.d/*.yml
  reload.enabled: false
processors:
- add_host_metadata:
    when.not.contains.tags: forwarded
- add_docker_metadata: null
- add_kubernetes_metadata: null
- timestamp:
    field: timestamp
    layouts:
    - '2006-01-02T15:04:05.000Z'
    - '2006-01-02T15:04:05Z'
    test:
    - '2023-01-01T12:00:00.000Z'
- drop_fields:
    fields:
    - agent
    - ecs
    - host.architecture
    - host.os.family
    ignore_missing: true
output.logstash:
  hosts:
  - logstash-security:5044
  compression_level: 3
  bulk_max_size: 2048
  worker: 2
setup.kibana:
  host: kibana-security:5601
  username: elastic
  password: acgs_security_2024
setup.template.settings:
  index.number_of_shards: 1
  index.number_of_replicas: 0
  index.refresh_interval: 5s
setup.ilm.enabled: true
setup.ilm.rollover_alias: filebeat-acgs
setup.ilm.pattern: '{now/d}-000001'
setup.ilm.policy: filebeat-acgs-policy
logging.level: info
logging.to_files: true
logging.files:
  path: /var/log/filebeat
  name: filebeat
  keepfiles: 7
  permissions: 420
monitoring.enabled: true
monitoring.elasticsearch:
  hosts:
  - elasticsearch-security:9200
  username: elastic
  password: acgs_security_2024
http.enabled: true
http.host: 0.0.0.0
http.port: 5066
ssl.verification_mode: none
queue.mem:
  events: 4096
  flush.min_events: 512
  flush.timeout: 1s
filebeat.registry.path: /usr/share/filebeat/data/registry
constitutional_hash: cdd01ef066bc6cf2
