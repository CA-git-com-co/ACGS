services:
  aici-controller:
    image: acgs/aici-controller:latest
    container_name: acgs-aici-controller
    restart: unless-stopped
    ports:
    - 8007:8007
    environment:
    - CONSTITUTIONAL_HASH=cdd01ef066bc6cf2
    - OPA_SERVICE_URL=http://opa:8181
    - REDIS_URL=redis://redis:6379/0
    volumes:
    - ${ACGS_ROOT}/config/opa/policies:/policies
    - ${ACGS_ROOT}/infrastructure/wasm:/wasm
    # depends_on:
    # - opa
    # - redis
    networks:
    - acgs-network
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          cpus: '0.2'
          memory: 256M
networks:
  acgs-network:
    external: true
# constitutional_hash: cdd01ef066bc6cf2
