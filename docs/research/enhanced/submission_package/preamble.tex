%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  PREAMBLE: AlphaEvolve-ACGS Research Paper                                    %
%  Document class, packages, and custom commands                                %
%  DATE: June 12, 2025                                                         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[10pt,twocolumn]{article}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %           Preamble: Packages          %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}        % Latin Modern fonts for better T1 encoding and fewer warnings
\usepackage{microtype}      % Superior typography and line breaking

% Load packages in this order to avoid conflicts
\usepackage{amsmath,amsfonts,amssymb,amsthm} % Load in this order to avoid conflicts
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{siunitx}        % Better number/unit alignment
\usepackage{array}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{url}
\usepackage[square,numbers,sort&compress]{natbib} % For citation management

% Better URL breaking in bibliography
\def\UrlBreaks{\do/\do-\do.\do=\do_}
\urlstyle{same}
\usepackage{algorithm}
\usepackage[noend]{algorithmic}
\usepackage{float}
\usepackage{subcaption}
\usepackage[dvipsnames]{xcolor}
\usepackage{listings}
\usepackage{geometry}
\usepackage{pifont}
\usepackage{tikz}
\usepackage{enumitem}
\usepackage{hyperref}       % Load hyperref last to avoid conflicts

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %         Font Configuration            %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Suppress font warnings by setting font substitution silently
\usepackage{silence}
\WarningFilter{latexfont}{Font shape}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %     Page Geometry & Layout Settings   %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\geometry{
    letterpaper,
    left=0.75in,
    right=0.75in,
    top=1in,
    bottom=1in,
    columnsep=0.25in
}
\setlength{\textfloatsep}{12pt plus 1.0pt minus 2.0pt}
\setlength{\floatsep}{12pt plus 1.0pt minus 2.0pt}
\setlength{\intextsep}{12pt plus 1.0pt minus 2.0pt}

% Better float placement parameters
\renewcommand{\topfraction}{0.9}
\renewcommand{\bottomfraction}{0.8}
\setcounter{topnumber}{2}
\setcounter{bottomnumber}{2}
\setcounter{totalnumber}{4}
\renewcommand{\dbltopfraction}{0.9}
\renewcommand{\textfraction}{0.07}
\renewcommand{\floatpagefraction}{0.7}
\renewcommand{\dblfloatpagefraction}{0.7}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %         Hyperref & Color Setup        %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hypersetup{
    colorlinks=true,
    linkcolor=blue!70!black,
    filecolor=magenta,
    urlcolor=blue!70!black,
    citecolor=ForestGreen!80!black,
    pdftitle={AlphaEvolve-ACGS: A Co-Evolutionary Framework for LLM-Driven Constitutional Governance},
    pdfauthor={Martin Honglin Lyu},
    pdfsubject={AI Governance},
    pdfkeywords={AI Governance, Evolutionary Computation, Constitutional AI, Large Language Models, Policy-as-Code, Open Policy Agent, Responsible AI}
}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %        Code & Algorithm Listings      %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\lstset{
    basicstyle=\ttfamily\scriptsize,
    breaklines=true,
    breakatwhitespace=true,
    prebreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
    frame=tb,
    language=Python,
    showstringspaces=false,
    numbers=left,
    numberstyle=\tiny\color{gray},
    keywordstyle=\color{blue},
    commentstyle=\color{ForestGreen},
    stringstyle=\color{purple},
    rulecolor=\color{black!20},
    backgroundcolor=\color{black!5},
    columns=flexible,
    keepspaces=true,
    tabsize=2
}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %       Custom Commands & Theorems      %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\acgs}{\textsc{AlphaEvolve-ACGS}}
\newcommand{\acgsshort}{\textsc{ACGS}}
\newcommand{\quantumagi}{\textsc{Quantumagi}}
% Bold-compatible version for titles (avoids bold+smallcaps font issue)
\newcommand{\acgsbold}{AlphaEvolve-ACGS}
\newcommand{\lipschitz}{\mathcal{L}}
\newcommand{\bigO}{\mathcal{O}}
% Avoid \checkmark conflicts by using custom command
\newcommand{\checkmarkcustom}{\ding{51}}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

% Enhanced hyphenation for technical terms
\hyphenation{Al-pha-E-volve-ACGS Quan-tu-ma-gi con-sti-tu-tion-al
gov-er-nance e-vo-lu-tion-ary com-pu-ta-tion crypto-graph-ic-ally
multi-stake-hold-er demo-crat-ic le-git-i-ma-cy frame-work
ar-chi-tec-ture en-force-ment val-i-da-tion syn-the-sis
op-er-a-tion-al prin-ci-ples pol-i-cies com-pli-ance}

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{definition}[theorem]{Definition}

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %        Typography Improvements        %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fix intersentence spacing after abbreviations
\newcommand{\eg}{e.g.\@}
\newcommand{\ie}{i.e.\@}
\newcommand{\etc}{etc.\@}
\newcommand{\vs}{vs.\@}

% Non-breaking spaces for units and references
\newcommand{\ms}{\,ms}
\newcommand{\percent}{\,\%}

% Better line breaking for technical terms
\newcommand{\allowlinebreak}{\discretionary{}{}{}}

% Enhanced line breaking for compound technical terms
\newcommand{\acgsbreak}{\textsc{AlphaEvolve\allowlinebreak-\allowlinebreak ACGS}}
\newcommand{\quantumagibreak}{\textsc{Quantum\allowlinebreak agi}}

% Improve line breaking globally with more aggressive settings
\tolerance=3000
\hbadness=3000
\emergencystretch=3em
\hfuzz=1pt
\widowpenalty=10000
\clubpenalty=10000
\vfuzz=1pt
\raggedbottom{}

% Additional line breaking improvements
\pretolerance=2000
\hyphenpenalty=50
\exhyphenpenalty=50
\doublehyphendemerits=10000
\finalhyphendemerits=5000
\adjdemerits=10000

% Microtype settings for superior typography
\microtypesetup{
    protrusion=true,
    expansion=true,
    tracking=true,
    kerning=true,
    spacing=false,  % Disable spacing to avoid TS1 warnings
    activate={true,nocompatibility}
}

% Disable microtype spacing warnings for TS1 encoding
\microtypecontext{spacing=nonfrench}

% Better spacing around mathematical expressions
\thinmuskip=3mu plus 1mu minus 1mu
\medmuskip=4mu plus 2mu minus 2mu
\thickmuskip=5mu plus 3mu minus 2mu
